<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico"><link rel="mask-icon" href="/images/favicon.ico" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.css" integrity="sha256-no0c5ccDODBwp+9hSmV5VvPpKwHCpbVzXHexIkupM6U=" crossorigin="anonymous"><script src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.js" integrity="sha256-a5YRB27CcBwBFcT5EF/f3E4vzIqyHrSR878nseNYw64=" crossorigin="anonymous"></script><script class="next-config" data-name="main" type="application/json">{&quot;hostname&quot;:&quot;seachan0117.github.io&quot;,&quot;root&quot;:&quot;&#x2F;&quot;,&quot;images&quot;:&quot;&#x2F;images&quot;,&quot;scheme&quot;:&quot;Gemini&quot;,&quot;version&quot;:&quot;8.5.0&quot;,&quot;exturl&quot;:false,&quot;sidebar&quot;:{&quot;position&quot;:&quot;left&quot;,&quot;display&quot;:&quot;post&quot;,&quot;padding&quot;:18,&quot;offset&quot;:12},&quot;copycode&quot;:true,&quot;bookmark&quot;:{&quot;enable&quot;:false,&quot;color&quot;:&quot;#222&quot;,&quot;save&quot;:&quot;auto&quot;},&quot;fancybox&quot;:true,&quot;mediumzoom&quot;:false,&quot;lazyload&quot;:false,&quot;pangu&quot;:false,&quot;comments&quot;:{&quot;style&quot;:&quot;tabs&quot;,&quot;active&quot;:&quot;gitalk&quot;,&quot;storage&quot;:true,&quot;lazyload&quot;:false,&quot;nav&quot;:null,&quot;activeClass&quot;:&quot;gitalk&quot;},&quot;motion&quot;:{&quot;enable&quot;:true,&quot;async&quot;:false,&quot;transition&quot;:{&quot;post_block&quot;:&quot;fadeIn&quot;,&quot;post_header&quot;:&quot;fadeInDown&quot;,&quot;post_body&quot;:&quot;fadeInDown&quot;,&quot;coll_header&quot;:&quot;fadeInLeft&quot;,&quot;sidebar&quot;:&quot;fadeInUp&quot;}},&quot;prism&quot;:false,&quot;i18n&quot;:{&quot;placeholder&quot;:&quot;搜索...&quot;,&quot;empty&quot;:&quot;没有找到任何搜索结果：${query}&quot;,&quot;hits_time&quot;:&quot;找到 ${hits} 个搜索结果（用时 ${time} 毫秒）&quot;,&quot;hits&quot;:&quot;找到 ${hits} 个搜索结果&quot;},&quot;path&quot;:&quot;&#x2F;search.xml&quot;,&quot;localsearch&quot;:{&quot;enable&quot;:true,&quot;trigger&quot;:&quot;auto&quot;,&quot;top_n_per_article&quot;:1,&quot;unescape&quot;:false,&quot;preload&quot;:false}}</script><script src="/js/config.js"></script><meta name="description" content="Sea Chan&#39;s blogs"><meta property="og:type" content="website"><meta property="og:title" content="SeaChan"><meta property="og:url" content="https://seachan0117.github.io/index.html"><meta property="og:site_name" content="SeaChan"><meta property="og:description" content="Sea Chan&#39;s blogs"><meta property="og:locale" content="zh_CN"><meta property="article:author" content="Sea Chan"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://seachan0117.github.io/"><script class="next-config" data-name="page" type="application/json">{&quot;sidebar&quot;:&quot;&quot;,&quot;isHome&quot;:true,&quot;isPost&quot;:false,&quot;lang&quot;:&quot;zh-CN&quot;,&quot;comments&quot;:&quot;&quot;,&quot;permalink&quot;:&quot;&quot;,&quot;path&quot;:&quot;index.html&quot;,&quot;title&quot;:&quot;&quot;}</script><script class="next-config" data-name="calendar" type="application/json">&quot;&quot;</script><title>SeaChan</title><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><a target="_blank" rel="noopener" href="https://github.com/SeaChan0117" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style><main class="main"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><h1 class="site-title">SeaChan</h1><i class="logo-line"></i></a></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div><aside class="sidebar"><div class="sidebar-inner sidebar-overview-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Sea Chan" src="/images/miao.png"><p class="site-author-name" itemprop="name">Sea Chan</p><div class="site-description" itemprop="description">Sea Chan's blogs</div></div><div class="site-state-wrap site-overview-item animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">14</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">11</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">13</span> <span class="site-state-item-name">标签</span></a></div></nav></div></div><div><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="210" height="80" src="//music.163.com/outchain/player?type=2&id=28996919&auto=0&height=66"></iframe></div></div></div></aside><div class="sidebar-dimmer"></div></header><div class="back-to-top" role="button" aria-label="返回顶部"><i class="fa fa-arrow-up"></i> <span>0%</span></div><div class="reading-progress-bar"></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner index posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content"><link itemprop="mainEntityOfPage" href="https://seachan0117.github.io/2021/08/10/hexo-usage/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/miao.png"><meta itemprop="name" content="Sea Chan"><meta itemprop="description" content="Sea Chan's blogs"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="SeaChan"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2021/08/10/hexo-usage/" class="post-title-link" itemprop="url">通过 Hexo 和 Travis 构建一个属于自己的博客</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2021-08-10 01:57:19" itemprop="dateCreated datePublished" datetime="2021-08-10T01:57:19+00:00">2021-08-10</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Tools/" itemprop="url" rel="index"><span itemprop="name">Tools</span></a></span></span></div></div></header><div class="post-body" itemprop="articleBody"><p>　　<strong>最近开启了大前端学习的道路，从事前端行业两年多了，想要一个自己的 Blog，不管是学习记录还是生活记录，都可以使用起来，而不是繁杂难选的三方平台，乘着学习过程中看到过的 Hexo＋Travis 的方式搭建自己的博客，我也兴致勃勃的想试试，此时你看到的就是搭建结果，这也是第一篇博客！</strong></p><h1 id="前置准备"><a href="#前置准备" class="headerlink" title="前置准备"></a>前置准备</h1><p>　　流浪在大前端的今天怎么能没有 node 呢，node 是必备的，大家自行安装即可=。=；</p><div class="post-button"><a class="btn" href="/2021/08/10/hexo-usage/#more" rel="contents">阅读全文 &raquo;</a></div></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content"><link itemprop="mainEntityOfPage" href="https://seachan0117.github.io/2021/08/10/gulp-02/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/miao.png"><meta itemprop="name" content="Sea Chan"><meta itemprop="description" content="Sea Chan's blogs"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="SeaChan"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2021/08/10/gulp-02/" class="post-title-link" itemprop="url">Gulp案例</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2021-08-10 09:23:06 / 修改时间：01:57:19" itemprop="dateCreated datePublished" datetime="2021-08-10T09:23:06+00:00">2021-08-10</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E5%A4%A7%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">大前端</span></a> </span>， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E5%A4%A7%E5%89%8D%E7%AB%AF/%E5%B7%A5%E7%A8%8B%E5%8C%96/" itemprop="url" rel="index"><span itemprop="name">工程化</span></a></span></span></div></div></header><div class="post-body" itemprop="articleBody"><p><img src="/2021/08/10/gulp-02/bg.jpg" alt="gulp"></p><p><a href="https://seachan0117.github.io/2021/06/11/gulp-01">上一篇</a>，我们学习了 <code>Gulp</code> 的一些基本原理和操作，本文通过小案例，去学习构建一个网页应用的自动化构建工作流。</p><p>首先准备一个用于构建网页应用的项目，项目目录大致如下，大家可以使用自己的；</p><p><img src="/2021/08/10/gulp-02/%E9%A1%B9%E7%9B%AE%E7%9B%AE%E5%BD%95.jpg" alt="项目目录"></p><p>接下来安装gulp到开发依赖，在根目录下新建 <code>gulpfile.js</code> 文件；</p><h1 id="样式编译任务"><a href="#样式编译任务" class="headerlink" title="样式编译任务"></a>样式编译任务</h1><p>样式文件读取拷贝到目标文件夹，<code>src</code> 第二个参数，<code>base</code> 之后的路径会按照原路径保存在 <code>dist</code> 下，否则所有文件都会直接放在 <code>dist</code>下；</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;src, dest&#125; = <span class="built_in">require</span>(<span class="string">&#x27;gulp&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> style = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> src(<span class="string">&#x27;src/assets/styles/*.scss&#x27;</span>, &#123;<span class="attr">base</span>: <span class="string">&#x27;src&#x27;</span>&#125;) <span class="comment">// base之后的路径会按照原路径(assets/styles/*)保存在dist下，否则所有文件都在dist下</span></span><br><span class="line">        .pipe(dest(<span class="string">&#x27;dist&#x27;</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;  <span class="comment">// 所有的任务都放这</span></span><br><span class="line">    style</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以上执行任务后得到的文件是原文件的拷贝（*.scss），还未完成转换，此时需要安装插件对文件流进行转换，<code>yarn add gulp-sass --dev</code>;</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;src, dest&#125; = <span class="built_in">require</span>(<span class="string">&#x27;gulp&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> sass = <span class="built_in">require</span>(<span class="string">&#x27;gulp-sass&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> style = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> src(<span class="string">&#x27;src/assets/styles/*.scss&#x27;</span>, &#123;<span class="attr">base</span>: <span class="string">&#x27;src&#x27;</span>&#125;) <span class="comment">// base之后的路径会按照原路径(assets/styles/*)保存在dist下，否则所有文件都在dist下</span></span><br><span class="line">        .pipe(sass(&#123;<span class="attr">outputStyle</span>: <span class="string">&#x27;expanded&#x27;</span>&#125;))       <span class="comment">// sass转换，参数： &#123;outputStyle: &#x27;expanded&#x27;&#125;  完全展开</span></span><br><span class="line">        .pipe(dest(<span class="string">&#x27;dist&#x27;</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;  <span class="comment">// 所有的任务都放这</span></span><br><span class="line">    style,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>执行 <code>yarn gulp style</code> 编译完成样式文件，可在 <code>dist</code> 下查看；</p><p>PS: 下划线开头的文件，<code>sass</code> 插件会忽略，不会进行转换；</p><p><img src="/2021/08/10/gulp-02/%E6%A0%B7%E5%BC%8F%E7%BC%96%E8%AF%91%E4%BB%BB%E5%8A%A1.jpg" alt="样式编译任务"></p><h1 id="脚本文件编译任务"><a href="#脚本文件编译任务" class="headerlink" title="脚本文件编译任务"></a>脚本文件编译任务</h1><p>安装转换流插件，<code>yarn add gulp-babel --dev</code>；执行脚本任务时，会报错 <code>Error: Cannot find module &#39;@babel/core&#39;</code>，是因为 <code>gulp-babel</code> 模块并没有转换功能，只是帮我们唤起 <code>@babel/core</code> 转换模块，我们需要手动安装，<code>yarn add @babel/core @babel/preset-env --dev</code>；</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;src, dest&#125; = <span class="built_in">require</span>(<span class="string">&#x27;gulp&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> babel = <span class="built_in">require</span>(<span class="string">&#x27;gulp-babel&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 脚本编译任务</span></span><br><span class="line"><span class="keyword">const</span> script = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> src(<span class="string">&#x27;src/assets/scripts/*.js&#x27;</span>, &#123;<span class="attr">base</span>: <span class="string">&#x27;src&#x27;</span>&#125;) <span class="comment">// base之后的路径会按照原路径(assets/styles/*)保存在dist下，否则所有文件都在dist下</span></span><br><span class="line">        .pipe(babel(&#123;<span class="attr">presets</span>: [<span class="string">&#x27;@babel/preset-env&#x27;</span>]&#125;))  <span class="comment">// babel转换   记住presets参数要传</span></span><br><span class="line">        .pipe(dest(<span class="string">&#x27;dist&#x27;</span>))</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;  <span class="comment">// 所有的任务都放这</span></span><br><span class="line">    style,</span><br><span class="line">    script,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>执行 <code>yarn gulp script</code> 编译完成脚本文件，可在 <code>dist</code> 下查看；</p><h1 id="页面文件编译任务"><a href="#页面文件编译任务" class="headerlink" title="页面文件编译任务"></a>页面文件编译任务</h1><p>为了让页面中一些可重用的部分抽象出来，可以使用模板引擎，案例中使用 <code>swig</code>，需要先安装 <code>swig</code> 的转换插件，<code>yarn add gulp-swig --dev</code>；</p><p><img src="/2021/08/10/gulp-02/%E9%A1%B5%E9%9D%A2%E7%BC%96%E8%AF%91%E4%BB%BB%E5%8A%A1.jpg" alt="页面编译任务"></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;src, dest&#125; = <span class="built_in">require</span>(<span class="string">&#x27;gulp&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> swig = <span class="built_in">require</span>(<span class="string">&#x27;gulp-swig&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 模拟模板数据，swig配置解析，推荐使用json文件，再读取载入进来</span></span><br><span class="line"><span class="keyword">const</span> data = &#123;</span><br><span class="line">    <span class="attr">menus</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;Home&#x27;</span>,</span><br><span class="line">            <span class="attr">icon</span>: <span class="string">&#x27;aperture&#x27;</span>,</span><br><span class="line">            <span class="attr">link</span>: <span class="string">&#x27;index.html&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;Features&#x27;</span>,</span><br><span class="line">            <span class="attr">link</span>: <span class="string">&#x27;features.html&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;About&#x27;</span>,</span><br><span class="line">            <span class="attr">link</span>: <span class="string">&#x27;about.html&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;Contact&#x27;</span>,</span><br><span class="line">            <span class="attr">link</span>: <span class="string">&#x27;#&#x27;</span>,</span><br><span class="line">            <span class="attr">children</span>: [</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">name</span>: <span class="string">&#x27;Twitter&#x27;</span>,</span><br><span class="line">                    <span class="attr">link</span>: <span class="string">&#x27;https://twitter.com&#x27;</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">name</span>: <span class="string">&#x27;About&#x27;</span>,</span><br><span class="line">                    <span class="attr">link</span>: <span class="string">&#x27;https://weibo.com&#x27;</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">name</span>: <span class="string">&#x27;divider&#x27;</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">name</span>: <span class="string">&#x27;GitHub&#x27;</span>,</span><br><span class="line">                    <span class="attr">link</span>: <span class="string">&#x27;https://github.com&#x27;</span></span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">pkg</span>: <span class="built_in">require</span>(<span class="string">&#x27;./package.json&#x27;</span>),</span><br><span class="line">    <span class="attr">date</span>: <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 页面编译任务</span></span><br><span class="line"><span class="keyword">const</span> page = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> src(<span class="string">&#x27;src/*.html&#x27;</span>, &#123;<span class="attr">base</span>: <span class="string">&#x27;src&#x27;</span>&#125;)     <span class="comment">// &#x27;src/**/*.html&#x27;可创建到对应路径，此处html都放在src下边，避免干扰，其他文件夹下的是布局页，不影响</span></span><br><span class="line">        .pipe(swig(&#123;data&#125;))</span><br><span class="line">        .pipe(dest(<span class="string">&#x27;dist&#x27;</span>))</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;  <span class="comment">// 所有的任务都放这</span></span><br><span class="line">    style,</span><br><span class="line">    script,</span><br><span class="line">    page,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>执行 <code>yarn gulp page</code> 编译完成页面文件，可在 <code>dist</code> 下查看；</p><p>以上完成了样式 + 脚本 + 页面文件的单个构建任务，接下来创建组合任务让他们都一次执行，因为三个任务互不干扰，可以创建并行任务，提高效率；</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 组合任务</span></span><br><span class="line"><span class="keyword">const</span> &#123;parallel&#125; = <span class="built_in">require</span>(<span class="string">&#x27;gulp&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> compile = parallel(style, script, page)</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    compile</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>执行 <code>yarn gulp compile</code> 得到组合任务结果：</p><p><img src="/2021/08/10/gulp-02/%E7%BB%84%E5%90%88%E4%BB%BB%E5%8A%A1.jpg" alt="组合任务"></p><h1 id="图片和字体文件的转换"><a href="#图片和字体文件的转换" class="headerlink" title="图片和字体文件的转换"></a>图片和字体文件的转换</h1><p>图片文件压缩转换，需要添加插件，<code>yarn add gulp-imagemin --dev</code>;</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> imagemin = <span class="built_in">require</span>(<span class="string">&#x27;gulp-imagemin&#x27;</span>)</span><br><span class="line"><span class="comment">// 图片转换</span></span><br><span class="line"><span class="keyword">const</span> image = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> src(<span class="string">&#x27;src/assets/images/**&#x27;</span>, &#123;<span class="attr">base</span>: <span class="string">&#x27;src&#x27;</span>&#125;)</span><br><span class="line">        .pipe(imagemin())</span><br><span class="line">        .pipe(dest(<span class="string">&#x27;dist&#x27;</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 字体文件转换</span></span><br><span class="line"><span class="keyword">const</span> font = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> src(<span class="string">&#x27;src/assets/fonts/**&#x27;</span>, &#123;<span class="attr">base</span>: <span class="string">&#x27;src&#x27;</span>&#125;)</span><br><span class="line">        .pipe(imagemin())</span><br><span class="line">        .pipe(dest(<span class="string">&#x27;dist&#x27;</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 组合任务</span></span><br><span class="line"><span class="keyword">const</span> compile = parallel(style, script, page, image, font)</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    compile,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="其他文件及文件清除"><a href="#其他文件及文件清除" class="headerlink" title="其他文件及文件清除"></a>其他文件及文件清除</h1><p><code>public</code> 目录下的文件；</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// public下</span></span><br><span class="line"><span class="keyword">const</span> extra = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> src(<span class="string">&#x27;public/**&#x27;</span>, &#123;<span class="attr">base</span>: <span class="string">&#x27;public&#x27;</span>&#125;)</span><br><span class="line">        .pipe(dest(<span class="string">&#x27;dist&#x27;</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 组合任务</span></span><br><span class="line"><span class="keyword">const</span> compile = parallel(style, script, page, image, font)      <span class="comment">// 编译</span></span><br><span class="line"><span class="keyword">const</span> build = parallel(compile, extra)      <span class="comment">// 构建</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    compile,</span><br><span class="line">    build,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>目前整个项目的构建任务基本完成了，但每次执行构建任务都要手动删除 <code>dist</code> 目录，我们使用一个插件来完成每次的自动删除；安装 <code>yarn add del --dev</code>；定义添加一个 <code>clean</code> 任务，用于每次执行构建任务前操作，此时的构建就需要 <code>series</code> 创建一个串行任务，先清空再执行后边的构建任务，然后我们的任务变成了这样：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 清除dist</span></span><br><span class="line"><span class="keyword">const</span> del  = <span class="built_in">require</span>(<span class="string">&#x27;del&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> clean = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> del([<span class="string">&#x27;dist&#x27;</span>])    <span class="comment">// del参数是路径集合</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 组合任务</span></span><br><span class="line"><span class="keyword">const</span> compile = parallel(style, script, page, image, font)      <span class="comment">// 编译</span></span><br><span class="line"><span class="keyword">const</span> build = series(clean, parallel(compile, extra))    <span class="comment">// 构建</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    compile,</span><br><span class="line">    build,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="自动加载插件"><a href="#自动加载插件" class="headerlink" title="自动加载插件"></a>自动加载插件</h1><p>随着构建越来越复杂，其中使用到的插件就越来越多，当我们 <code>require</code> 一堆插件时，代码开始显得很繁杂，我们可以通过一个插件去管理 <code>yarn add gulp-load-plugins --dev</code>；导入插件后对之前使用到的插件做相应替换，代码变成了下边的样子：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;src, dest, parallel, series&#125; = <span class="built_in">require</span>(<span class="string">&#x27;gulp&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> loadPlugins = <span class="built_in">require</span>(<span class="string">&#x27;gulp-load-plugins&#x27;</span>)    <span class="comment">// 导入gulp-load-plugins，它是一个方法</span></span><br><span class="line"><span class="keyword">const</span> plugins = loadPlugins()   <span class="comment">// 获取plugins对象，属性是各个gulp插件名除去gulp-开头后的部分，后续有短横线使用驼峰</span></span><br><span class="line"><span class="keyword">const</span> del  = <span class="built_in">require</span>(<span class="string">&#x27;del&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 模板数据，swig配置解析，推荐使用json文件，再读取载入进来</span></span><br><span class="line"><span class="keyword">const</span> data = &#123;</span><br><span class="line">    <span class="attr">menus</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;Home&#x27;</span>,</span><br><span class="line">            <span class="attr">icon</span>: <span class="string">&#x27;aperture&#x27;</span>,</span><br><span class="line">            <span class="attr">link</span>: <span class="string">&#x27;index.html&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;Features&#x27;</span>,</span><br><span class="line">            <span class="attr">link</span>: <span class="string">&#x27;features.html&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;About&#x27;</span>,</span><br><span class="line">            <span class="attr">link</span>: <span class="string">&#x27;about.html&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;Contact&#x27;</span>,</span><br><span class="line">            <span class="attr">link</span>: <span class="string">&#x27;#&#x27;</span>,</span><br><span class="line">            <span class="attr">children</span>: [</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">name</span>: <span class="string">&#x27;Twitter&#x27;</span>,</span><br><span class="line">                    <span class="attr">link</span>: <span class="string">&#x27;https://twitter.com&#x27;</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">name</span>: <span class="string">&#x27;About&#x27;</span>,</span><br><span class="line">                    <span class="attr">link</span>: <span class="string">&#x27;https://weibo.com&#x27;</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">name</span>: <span class="string">&#x27;divider&#x27;</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">name</span>: <span class="string">&#x27;GitHub&#x27;</span>,</span><br><span class="line">                    <span class="attr">link</span>: <span class="string">&#x27;https://github.com&#x27;</span></span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">pkg</span>: <span class="built_in">require</span>(<span class="string">&#x27;./package.json&#x27;</span>),</span><br><span class="line">    <span class="attr">date</span>: <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 样式编译任务</span></span><br><span class="line"><span class="keyword">const</span> style = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> src(<span class="string">&#x27;src/assets/styles/*.scss&#x27;</span>, &#123;<span class="attr">base</span>: <span class="string">&#x27;src&#x27;</span>&#125;) <span class="comment">// base之后的路径会按照原路径(assets/styles/*)保存在dist下，否则所有文件都在dist下</span></span><br><span class="line">        .pipe(plugins.sass(&#123;<span class="attr">outputStyle</span>: <span class="string">&#x27;expanded&#x27;</span>&#125;))       <span class="comment">// sass转换，参数： &#123;outputStyle: &#x27;expanded&#x27;&#125;  完全展开</span></span><br><span class="line">        .pipe(dest(<span class="string">&#x27;dist&#x27;</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 脚本编译任务</span></span><br><span class="line"><span class="keyword">const</span> script = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> src(<span class="string">&#x27;src/assets/scripts/*.js&#x27;</span>, &#123;<span class="attr">base</span>: <span class="string">&#x27;src&#x27;</span>&#125;) <span class="comment">// base之后的路径会按照原路径(assets/styles/*)保存在dist下，否则所有文件都在dist下</span></span><br><span class="line">        .pipe(plugins.babel(&#123;<span class="attr">presets</span>: [<span class="string">&#x27;@babel/preset-env&#x27;</span>]&#125;))  <span class="comment">// babel转换   记住presets参数要传</span></span><br><span class="line">        .pipe(dest(<span class="string">&#x27;dist&#x27;</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 页面编译任务</span></span><br><span class="line"><span class="keyword">const</span> page = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> src(<span class="string">&#x27;src/*.html&#x27;</span>, &#123;<span class="attr">base</span>: <span class="string">&#x27;src&#x27;</span>&#125;)     <span class="comment">// &#x27;src/**/*.html&#x27;可创建到对应路径，此处都放在src下边</span></span><br><span class="line">        .pipe(plugins.swig(&#123;data&#125;))</span><br><span class="line">        .pipe(dest(<span class="string">&#x27;dist&#x27;</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 图片转换</span></span><br><span class="line"><span class="keyword">const</span> image = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> src(<span class="string">&#x27;src/assets/images/**&#x27;</span>, &#123;<span class="attr">base</span>: <span class="string">&#x27;src&#x27;</span>&#125;)</span><br><span class="line">        .pipe(plugins.imagemin())</span><br><span class="line">        .pipe(dest(<span class="string">&#x27;dist&#x27;</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 字体文件转换</span></span><br><span class="line"><span class="keyword">const</span> font = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> src(<span class="string">&#x27;src/assets/fonts/**&#x27;</span>, &#123;<span class="attr">base</span>: <span class="string">&#x27;src&#x27;</span>&#125;)</span><br><span class="line">        .pipe(plugins.imagemin())</span><br><span class="line">        .pipe(dest(<span class="string">&#x27;dist&#x27;</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// public下</span></span><br><span class="line"><span class="keyword">const</span> extra = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> src(<span class="string">&#x27;public/**&#x27;</span>, &#123;<span class="attr">base</span>: <span class="string">&#x27;public&#x27;</span>&#125;)</span><br><span class="line">        .pipe(dest(<span class="string">&#x27;dist&#x27;</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 清除dist</span></span><br><span class="line"><span class="keyword">const</span> clean = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> del([<span class="string">&#x27;dist&#x27;</span>])    <span class="comment">// del参数是路径集合</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 组合任务</span></span><br><span class="line"><span class="keyword">const</span> compile = parallel(style, script, page, image, font)      <span class="comment">// 编译</span></span><br><span class="line"><span class="keyword">const</span> build = series(clean, parallel(compile, extra))    <span class="comment">// 构建</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    compile,</span><br><span class="line">    build,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="热更新开发服务器"><a href="#热更新开发服务器" class="headerlink" title="热更新开发服务器"></a>热更新开发服务器</h1><p>以上是代码的构建基本流程，除了代码构建，我们还需要在开发阶段启动一个服务器用于调试代码；<code>gulp</code> 也为我们提供了相应的功能，配合其他的构建任务，在我们代码修改过后完成自动的编译，自动地刷新浏览器页面；</p><p>首先安装一个 <code>browser-sync</code> 的模块，<code>yarn add browser-sync --dev</code>；</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> browserSync = <span class="built_in">require</span>(<span class="string">&#x27;browser-sync&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> bs = browserSync.create()</span><br><span class="line"><span class="comment">// 热更新服务</span></span><br><span class="line"><span class="keyword">const</span> serve = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    bs.init(&#123;</span><br><span class="line">        <span class="attr">notify</span>: <span class="literal">false</span>,  <span class="comment">// 服务启动时，浏览器右上角的提示关闭</span></span><br><span class="line">        <span class="attr">port</span>: <span class="number">2080</span>,     <span class="comment">// 默认值 3000</span></span><br><span class="line">        <span class="comment">// open: false, // 启动时是否自动打开浏览器，默认值true</span></span><br><span class="line">        <span class="attr">files</span>: <span class="string">&#x27;dist/**&#x27;</span>,      <span class="comment">// 服务器启动后监听的路径通配符，对应的文件修改后就可以热更新</span></span><br><span class="line">        <span class="attr">server</span>: &#123;</span><br><span class="line">            <span class="attr">baseDir</span>: <span class="string">&#x27;dist&#x27;</span>,     <span class="comment">// 服务代码的根目录</span></span><br><span class="line">            <span class="attr">routes</span>: &#123;</span><br><span class="line">                <span class="string">&#x27;/node_modules&#x27;</span>: <span class="string">&#x27;node_modules&#x27;</span>  <span class="comment">// 路径映射，优于baseDir，相关配置找不到再找baseDir</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    compile,</span><br><span class="line">    build,</span><br><span class="line">    serve,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>yarn gulp serve</code> 执行任务后，浏览器自动启动并打开项目默认页面，修改 <code>dist</code> 目录下的文件，页面能实时刷新；</p><h1 id="监视变化以及构建优化"><a href="#监视变化以及构建优化" class="headerlink" title="监视变化以及构建优化"></a>监视变化以及构建优化</h1><p>现在我们有了开发服务器，也能实时监视 <code>dist</code> 目录下的变化实时刷新浏览器，但实际开发过程中，我们修改的代码并不是 <code>dist</code> 目录，此时我们还需要另一个插件 <code>watch</code> 来帮助监听某个路径下的变化来决定是否要重新执行的任务；</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;src, dest, parallel, series, watch&#125; = <span class="built_in">require</span>(<span class="string">&#x27;gulp&#x27;</span>)  <span class="comment">// 导入watch</span></span><br><span class="line"><span class="comment">// 热更新服务</span></span><br><span class="line"><span class="keyword">const</span> serve = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 监听以下文件路径的通配符，文件修改后执行对应任务</span></span><br><span class="line">    watch(<span class="string">&#x27;src/assets/styles/*.scss&#x27;</span>, style)</span><br><span class="line">    watch(<span class="string">&#x27;src/assets/scripts/*.js&#x27;</span>, script)</span><br><span class="line">    watch(<span class="string">&#x27;src/*.html&#x27;</span>, page)</span><br><span class="line">    watch(<span class="string">&#x27;src/assets/images/**&#x27;</span>, image)</span><br><span class="line">    watch(<span class="string">&#x27;src/assets/fonts/**&#x27;</span>, font)</span><br><span class="line">    watch(<span class="string">&#x27;public/**&#x27;</span>, extra)</span><br><span class="line"></span><br><span class="line">    bs.init(&#123;</span><br><span class="line">        <span class="attr">notify</span>: <span class="literal">false</span>,  <span class="comment">// 服务启动时，浏览器右上角的提示关闭</span></span><br><span class="line">        <span class="attr">port</span>: <span class="number">2080</span>,     <span class="comment">// 默认值 3000</span></span><br><span class="line">        <span class="comment">// open: false, // 启动时是否自动打开浏览器，默认值true</span></span><br><span class="line">        <span class="attr">files</span>: <span class="string">&#x27;dist/**&#x27;</span>,      <span class="comment">// 服务器启动后监听的路径通配符，对应的文件修改后就可以热更新</span></span><br><span class="line">        <span class="attr">server</span>: &#123;</span><br><span class="line">            <span class="attr">baseDir</span>: <span class="string">&#x27;dist&#x27;</span>,     <span class="comment">// 服务代码的根目录</span></span><br><span class="line">            <span class="attr">routes</span>: &#123;</span><br><span class="line">                <span class="string">&#x27;/node_modules&#x27;</span>: <span class="string">&#x27;node_modules&#x27;</span>  <span class="comment">// 路径映射，优于baseDir，相关配置找不到再找baseDir</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>保存后重启 <code>serve</code> 任务，修改 <code>src</code> 下的任意文件，浏览器即可实时同步刷新。</p><p>以上完成后还需对任务做一些调整，将静态资源（图片字体等）的构建任务放在 <code>build</code> 下，然后将 <code>compile</code> 和 <code>serve</code> 放一起成为开发阶段的组合任务 <code>develop</code>；</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 热更新服务</span></span><br><span class="line"><span class="keyword">const</span> serve = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 监听以下文件路径的通配符，文件修改后执行对应任务</span></span><br><span class="line">    watch(<span class="string">&#x27;src/assets/styles/*.scss&#x27;</span>, style)</span><br><span class="line">    watch(<span class="string">&#x27;src/assets/scripts/*.js&#x27;</span>, script)</span><br><span class="line">    watch(<span class="string">&#x27;src/*.html&#x27;</span>, page)</span><br><span class="line">    <span class="comment">// watch(&#x27;src/assets/images/**&#x27;, image)     // 对于这些静态资源开发阶段的监听意义不大，反而增加了任务开销，在bs中添加baseDir初始化就行</span></span><br><span class="line">    <span class="comment">// watch(&#x27;src/assets/fonts/**&#x27;, font)</span></span><br><span class="line">    <span class="comment">// watch(&#x27;public/**&#x27;, extra)</span></span><br><span class="line">    watch([                         <span class="comment">// 对于静态资源改变也需要热更新，不需要编译转换，只需要服务刷新就行</span></span><br><span class="line">        <span class="string">&#x27;src/assets/images/**&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;src/assets/fonts/**&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;public/**&#x27;</span>,</span><br><span class="line">    ], bs.reload)</span><br><span class="line"></span><br><span class="line">    bs.init(&#123;</span><br><span class="line">        <span class="attr">notify</span>: <span class="literal">false</span>,  <span class="comment">// 服务启动时，浏览器右上角的提示关闭</span></span><br><span class="line">        <span class="attr">port</span>: <span class="number">2080</span>,     <span class="comment">// 默认值 3000</span></span><br><span class="line">        <span class="comment">// open: false, // 启动时是否自动打开浏览器，默认值true</span></span><br><span class="line">        <span class="attr">files</span>: <span class="string">&#x27;dist/**&#x27;</span>,      <span class="comment">// 服务器启动后监听的路径通配符，对应的文件修改后就可以热更新</span></span><br><span class="line">        <span class="attr">server</span>: &#123;</span><br><span class="line">            <span class="attr">baseDir</span>: [<span class="string">&#x27;dist&#x27;</span>, <span class="string">&#x27;src&#x27;</span>, <span class="string">&#x27;public&#x27;</span>],     <span class="comment">// 服务代码的根目录</span></span><br><span class="line">            <span class="attr">routes</span>: &#123;</span><br><span class="line">                <span class="string">&#x27;/node_modules&#x27;</span>: <span class="string">&#x27;node_modules&#x27;</span>  <span class="comment">// 路径映射，优于baseDir，相关配置找不到再找baseDir</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 组合任务</span></span><br><span class="line"><span class="keyword">const</span> compile = parallel(style, script, page)      <span class="comment">// 编译</span></span><br><span class="line"><span class="keyword">const</span> build = series(clean, parallel(compile, image, font, extra))    <span class="comment">// 构建</span></span><br><span class="line"><span class="keyword">const</span> develop = series(compile, serve)      <span class="comment">// 开发阶段构建+热更新服务</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    compile,</span><br><span class="line">    build,</span><br><span class="line">    develop,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>此时执行启动 <code>develop</code> 任务后，生成的 <code>dist</code> 下图片字体等静态资源的文件是没有的，通过 <code>baseDir</code> 下从 <code>src</code> 和 <code>public</code> 下取，开发过程中减少了构建任务；</p><p><code>bs.init</code> 中监听files的参数可以去掉，改为对应的任务后使用 <code>.pipe(bs.reload(&#123;stream:true&#125;))</code> ，结果一样可以得到想要的热更新，只是写法上的差异；</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 样式编译任务</span></span><br><span class="line"><span class="keyword">const</span> style = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> src(<span class="string">&#x27;src/assets/styles/*.scss&#x27;</span>, &#123;<span class="attr">base</span>: <span class="string">&#x27;src&#x27;</span>&#125;) <span class="comment">// base之后的路径会按照原路径(assets/styles/*)保存在dist下，否则所有文件都在dist下</span></span><br><span class="line">        .pipe(plugins.sass(&#123;<span class="attr">outputStyle</span>: <span class="string">&#x27;expanded&#x27;</span>&#125;))       <span class="comment">// sass转换，参数： &#123;outputStyle: &#x27;expanded&#x27;&#125;  完全展开</span></span><br><span class="line">        .pipe(dest(<span class="string">&#x27;dist&#x27;</span>))</span><br><span class="line">        .pipe(bs.reload(&#123;<span class="attr">stream</span>: <span class="literal">true</span>&#125;))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 脚本编译任务</span></span><br><span class="line"><span class="keyword">const</span> script = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> src(<span class="string">&#x27;src/assets/scripts/*.js&#x27;</span>, &#123;<span class="attr">base</span>: <span class="string">&#x27;src&#x27;</span>&#125;) <span class="comment">// base之后的路径会按照原路径(assets/styles/*)保存在dist下，否则所有文件都在dist下</span></span><br><span class="line">        .pipe(plugins.babel(&#123;<span class="attr">presets</span>: [<span class="string">&#x27;@babel/preset-env&#x27;</span>]&#125;))  <span class="comment">// babel转换   记住presets参数要传</span></span><br><span class="line">        .pipe(dest(<span class="string">&#x27;dist&#x27;</span>))</span><br><span class="line">        .pipe(bs.reload(&#123;<span class="attr">stream</span>: <span class="literal">true</span>&#125;))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 页面编译任务</span></span><br><span class="line"><span class="keyword">const</span> page = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> src(<span class="string">&#x27;src/*.html&#x27;</span>, &#123;<span class="attr">base</span>: <span class="string">&#x27;src&#x27;</span>&#125;)     <span class="comment">// &#x27;src/**/*.html&#x27;可创建到对应路径，此处都放在src下边</span></span><br><span class="line">        .pipe(plugins.swig(&#123;data, <span class="attr">defaults</span>: &#123; <span class="attr">cache</span>: <span class="literal">false</span> &#125;&#125;))     <span class="comment">// cache:false防止模板缓存导致页面不能及时更新</span></span><br><span class="line">        .pipe(dest(<span class="string">&#x27;dist&#x27;</span>))</span><br><span class="line">        .pipe(bs.reload(&#123;<span class="attr">stream</span>: <span class="literal">true</span>&#125;))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="useref-引用文件处理"><a href="#useref-引用文件处理" class="headerlink" title="useref 引用文件处理"></a>useref 引用文件处理</h1><p>通过 <code>build</code> 任务我们需要得到一个最终发布版本的包，但之前我们在 <code>bs</code> 服务中做了一个路由映射处理了 <code>node_modules</code> 下边的依赖，如果线上使用该构建包，相应的依赖是找不到的，现在需要对它们进一步处理；</p><p>我们使用一个插件 <code>useref</code> ，<code>yarn add gulp-useref -- dev</code> ，它能根据对应的注释模板，将其中相应引入路径下的文件，编译转换后放到注释中规定的目录文件中；如下，会将 <code>&quot;/node_modules/bootstrap/dist/css/bootstrap.css&quot;</code> 找到并编译压缩后放在 <code>assets/styles/vendor.css</code> 中，如果 <code>build</code> 和 <code>endbuild</code> 之间有多个文件，将统一放在一个文件中；</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- build:css assets/styles/vendor.css --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/node_modules/bootstrap/dist/css/bootstrap.css&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- endbuild --&gt;</span></span><br></pre></td></tr></table></figure><p>添加 <code>useref</code> 任务</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> useref = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> src(<span class="string">&#x27;dist/*.html&#x27;</span>, &#123;<span class="attr">base</span>: <span class="string">&#x27;dist&#x27;</span>&#125;)</span><br><span class="line">        .pipe(plugins.useref(&#123;<span class="attr">searchPath</span>: [<span class="string">&#x27;dist&#x27;</span>, <span class="string">&#x27;.&#x27;</span>]&#125;))</span><br><span class="line">        .pipe(dest(<span class="string">&#x27;dist&#x27;</span>))</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    compile,</span><br><span class="line">    build,</span><br><span class="line">    develop,</span><br><span class="line">    useref,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>执行 <code>useref</code> 任务后，<code>dist/assets/styles</code> 下的多了 <code>vendor.css</code> ，<code>dist/assets/scripts</code> 下多了 <code>vendor.js</code> ，<code>html</code> 中涉及<code>node_modules</code> 的依赖也已相应转换；</p><p><img src="/2021/08/10/gulp-02/useref%E4%BB%BB%E5%8A%A101.jpg" alt="useref任务"></p><p><img src="/2021/08/10/gulp-02/useref%E4%BB%BB%E5%8A%A102.jpg" alt="useref任务"></p><p><img src="/2021/08/10/gulp-02/useref%E4%BB%BB%E5%8A%A103.jpg" alt="useref任务"></p><h1 id="文件压缩"><a href="#文件压缩" class="headerlink" title="文件压缩"></a>文件压缩</h1><p>上边使用 <code>useref</code> 后，我们已经能得到相关的 <code>css</code> 和 <code>js</code> 文件，但是都是内容全拷贝过来的，我们还可以对其进行一系列的压缩减少构建包的大小；针对 <code>html</code>，<code>css</code>，<code>js</code> 安装相应的插件进行压缩，<code>yarn add gulp-htmlmin gulp-clean-css gulp-uglify --dev</code> ，此时还需要一个判断文件类型的插件，<code>yarn add gulp-if --dev</code> ，判断文件后针对不同文件使用不同的压缩插件；</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> useref = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> src(<span class="string">&#x27;dist/*.html&#x27;</span>, &#123;<span class="attr">base</span>: <span class="string">&#x27;dist&#x27;</span>&#125;)</span><br><span class="line">        .pipe(plugins.useref(&#123;<span class="attr">searchPath</span>: [<span class="string">&#x27;dist&#x27;</span>, <span class="string">&#x27;.&#x27;</span>]&#125;))</span><br><span class="line">        .pipe(plugins.if(<span class="regexp">/\.html$/</span>, plugins.htmlmin(&#123;</span><br><span class="line">            <span class="attr">collapseWhitespace</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">minifyCSS</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">minifyJS</span>: <span class="literal">true</span></span><br><span class="line">        &#125;)))     <span class="comment">// html压缩</span></span><br><span class="line">        .pipe(plugins.if(<span class="regexp">/\.css$/</span>, plugins.cleanCss()))     <span class="comment">// css压缩</span></span><br><span class="line">        .pipe(plugins.if(<span class="regexp">/\.js$/</span>, plugins.uglify()))        <span class="comment">// js压缩</span></span><br><span class="line">        .pipe(dest(<span class="string">&#x27;release&#x27;</span>))          <span class="comment">// 目标文件夹由dist改为其他，防止读写冲突导致读写失败</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>重新执行 <code>compile</code> 和 <code>useref</code> 到 <code>release</code> 目录查看相应文件吧；</p><h2 id="重新规划构建过程"><a href="#重新规划构建过程" class="headerlink" title="重新规划构建过程"></a>重新规划构建过程</h2><p>使用 <code>useref</code> 后，我们之前的构建结构被打破了，我们之前定好的打包目录是 <code>dist</code> ，但是使用 <code>useref</code> 时为了解决文件冲突，我们重新放在了 <code>release</code> 目录，即 <code>release</code> 成了要上线的包文件，然而 <code>release</code> 下现在又没有图片字体等静态资源文件，所以需要对构建任务进行重新规划；思路：之前的任务使用 <code>temp</code> 临时目录，最后将 <code>temp</code> 目录下的文件转化后归整到 <code>dist</code> ；</p><p>调整后代码为：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;src, dest, parallel, series, watch&#125; = <span class="built_in">require</span>(<span class="string">&#x27;gulp&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> del = <span class="built_in">require</span>(<span class="string">&#x27;del&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> loadPlugins = <span class="built_in">require</span>(<span class="string">&#x27;gulp-load-plugins&#x27;</span>)    <span class="comment">// 导入gulp-load-plugins，它是一个方法</span></span><br><span class="line"><span class="keyword">const</span> plugins = loadPlugins()   <span class="comment">// 获取plugins对象，属性是各个gulp插件名除去gulp-开头后的部分，后续有短横线使用驼峰</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> browserSync = <span class="built_in">require</span>(<span class="string">&#x27;browser-sync&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> bs = browserSync.create()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 模板数据，swig配置解析，推荐使用json文件，再读取载入进来</span></span><br><span class="line"><span class="keyword">const</span> data = &#123;</span><br><span class="line">    <span class="attr">menus</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;Home&#x27;</span>,</span><br><span class="line">            <span class="attr">icon</span>: <span class="string">&#x27;aperture&#x27;</span>,</span><br><span class="line">            <span class="attr">link</span>: <span class="string">&#x27;index.html&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;Features&#x27;</span>,</span><br><span class="line">            <span class="attr">link</span>: <span class="string">&#x27;features.html&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;About&#x27;</span>,</span><br><span class="line">            <span class="attr">link</span>: <span class="string">&#x27;about.html&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;Contact&#x27;</span>,</span><br><span class="line">            <span class="attr">link</span>: <span class="string">&#x27;#&#x27;</span>,</span><br><span class="line">            <span class="attr">children</span>: [</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">name</span>: <span class="string">&#x27;Twitter&#x27;</span>,</span><br><span class="line">                    <span class="attr">link</span>: <span class="string">&#x27;https://twitter.com&#x27;</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">name</span>: <span class="string">&#x27;About&#x27;</span>,</span><br><span class="line">                    <span class="attr">link</span>: <span class="string">&#x27;https://weibo.com&#x27;</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">name</span>: <span class="string">&#x27;divider&#x27;</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">name</span>: <span class="string">&#x27;GitHub&#x27;</span>,</span><br><span class="line">                    <span class="attr">link</span>: <span class="string">&#x27;https://github.com&#x27;</span></span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">pkg</span>: <span class="built_in">require</span>(<span class="string">&#x27;./package.json&#x27;</span>),</span><br><span class="line">    <span class="attr">date</span>: <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 样式编译任务</span></span><br><span class="line"><span class="keyword">const</span> style = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> src(<span class="string">&#x27;src/assets/styles/*.scss&#x27;</span>, &#123;<span class="attr">base</span>: <span class="string">&#x27;src&#x27;</span>&#125;) <span class="comment">// base之后的路径会按照原路径(assets/styles/*)保存在dist下，否则所有文件都在dist下</span></span><br><span class="line">        .pipe(plugins.sass(&#123;<span class="attr">outputStyle</span>: <span class="string">&#x27;expanded&#x27;</span>&#125;))       <span class="comment">// sass转换，参数： &#123;outputStyle: &#x27;expanded&#x27;&#125;  完全展开</span></span><br><span class="line">        .pipe(dest(<span class="string">&#x27;temp&#x27;</span>))</span><br><span class="line">        .pipe(bs.reload(&#123;<span class="attr">stream</span>: <span class="literal">true</span>&#125;))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 脚本编译任务</span></span><br><span class="line"><span class="keyword">const</span> script = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> src(<span class="string">&#x27;src/assets/scripts/*.js&#x27;</span>, &#123;<span class="attr">base</span>: <span class="string">&#x27;src&#x27;</span>&#125;) <span class="comment">// base之后的路径会按照原路径(assets/styles/*)保存在dist下，否则所有文件都在dist下</span></span><br><span class="line">        .pipe(plugins.babel(&#123;<span class="attr">presets</span>: [<span class="string">&#x27;@babel/preset-env&#x27;</span>]&#125;))  <span class="comment">// babel转换   记住presets参数要传</span></span><br><span class="line">        .pipe(dest(<span class="string">&#x27;temp&#x27;</span>))</span><br><span class="line">        .pipe(bs.reload(&#123;<span class="attr">stream</span>: <span class="literal">true</span>&#125;))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 页面编译任务</span></span><br><span class="line"><span class="keyword">const</span> page = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> src(<span class="string">&#x27;src/*.html&#x27;</span>, &#123;<span class="attr">base</span>: <span class="string">&#x27;src&#x27;</span>&#125;)     <span class="comment">// &#x27;src/**/*.html&#x27;可创建到对应路径，此处都放在src下边</span></span><br><span class="line">        .pipe(plugins.swig(&#123;data, <span class="attr">defaults</span>: &#123;<span class="attr">cache</span>: <span class="literal">false</span>&#125;&#125;))     <span class="comment">// cache:false防止模板缓存导致页面不能及时更新</span></span><br><span class="line">        .pipe(dest(<span class="string">&#x27;temp&#x27;</span>))</span><br><span class="line">        .pipe(bs.reload(&#123;<span class="attr">stream</span>: <span class="literal">true</span>&#125;))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 图片转换</span></span><br><span class="line"><span class="keyword">const</span> image = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> src(<span class="string">&#x27;src/assets/images/**&#x27;</span>, &#123;<span class="attr">base</span>: <span class="string">&#x27;src&#x27;</span>&#125;)</span><br><span class="line">        .pipe(plugins.imagemin())</span><br><span class="line">        .pipe(dest(<span class="string">&#x27;dist&#x27;</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 字体文件转换</span></span><br><span class="line"><span class="keyword">const</span> font = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> src(<span class="string">&#x27;src/assets/fonts/**&#x27;</span>, &#123;<span class="attr">base</span>: <span class="string">&#x27;src&#x27;</span>&#125;)</span><br><span class="line">        .pipe(plugins.imagemin())</span><br><span class="line">        .pipe(dest(<span class="string">&#x27;dist&#x27;</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// public下</span></span><br><span class="line"><span class="keyword">const</span> extra = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> src(<span class="string">&#x27;public/**&#x27;</span>, &#123;<span class="attr">base</span>: <span class="string">&#x27;public&#x27;</span>&#125;)</span><br><span class="line">        .pipe(dest(<span class="string">&#x27;dist&#x27;</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 清除dist</span></span><br><span class="line"><span class="keyword">const</span> clean = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> del([<span class="string">&#x27;dist&#x27;</span>, <span class="string">&#x27;temp&#x27;</span>])    <span class="comment">// del参数是路径集合</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 热更新服务</span></span><br><span class="line"><span class="keyword">const</span> serve = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 监听以下文件路径的通配符，文件修改后执行对应任务</span></span><br><span class="line">    watch(<span class="string">&#x27;src/assets/styles/*.scss&#x27;</span>, style)</span><br><span class="line">    watch(<span class="string">&#x27;src/assets/scripts/*.js&#x27;</span>, script)</span><br><span class="line">    watch(<span class="string">&#x27;src/*.html&#x27;</span>, page)</span><br><span class="line">    <span class="comment">// watch(&#x27;src/assets/images/**&#x27;, image)     // 对于这些静态资源开发阶段的监听意义不大，反而增加了任务开销，在bs中添加baseDir初始化就行</span></span><br><span class="line">    <span class="comment">// watch(&#x27;src/assets/fonts/**&#x27;, font)</span></span><br><span class="line">    <span class="comment">// watch(&#x27;public/**&#x27;, extra)</span></span><br><span class="line">    watch([                         <span class="comment">// 对于静态资源改变也需要热更新，不需要编译转换，只需要服务刷新就行</span></span><br><span class="line">        <span class="string">&#x27;src/assets/images/**&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;src/assets/fonts/**&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;public/**&#x27;</span>,</span><br><span class="line">    ], bs.reload)</span><br><span class="line"></span><br><span class="line">    bs.init(&#123;</span><br><span class="line">        <span class="attr">notify</span>: <span class="literal">false</span>,  <span class="comment">// 服务启动时，浏览器右上角的提示关闭</span></span><br><span class="line">        <span class="attr">port</span>: <span class="number">2080</span>,     <span class="comment">// 默认值 3000</span></span><br><span class="line">        <span class="comment">// open: false, // 启动时是否自动打开浏览器，默认值true</span></span><br><span class="line">        <span class="comment">// files: &#x27;dist/**&#x27;,      // 服务器启动后监听的路径通配符，对应的文件修改后就可以热更新;在对应任务后使用bs.reload就可以不使用files监听</span></span><br><span class="line">        <span class="attr">server</span>: &#123;</span><br><span class="line">            <span class="attr">baseDir</span>: [<span class="string">&#x27;temp&#x27;</span>, <span class="string">&#x27;src&#x27;</span>, <span class="string">&#x27;public&#x27;</span>],     <span class="comment">// 服务代码的根目录</span></span><br><span class="line">            <span class="attr">routes</span>: &#123;</span><br><span class="line">                <span class="string">&#x27;/node_modules&#x27;</span>: <span class="string">&#x27;node_modules&#x27;</span>  <span class="comment">// 路径映射，优于baseDir，相关配置找不到再找baseDir</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> useref = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> src(<span class="string">&#x27;temp/*.html&#x27;</span>, &#123;<span class="attr">base</span>: <span class="string">&#x27;temp&#x27;</span>&#125;)</span><br><span class="line">        .pipe(plugins.useref(&#123;<span class="attr">searchPath</span>: [<span class="string">&#x27;temp&#x27;</span>, <span class="string">&#x27;.&#x27;</span>]&#125;))</span><br><span class="line">        .pipe(plugins.if(<span class="regexp">/\.html$/</span>, plugins.htmlmin(&#123;</span><br><span class="line">            <span class="attr">collapseWhitespace</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">minifyCSS</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">minifyJS</span>: <span class="literal">true</span></span><br><span class="line">        &#125;)))     <span class="comment">// html压缩</span></span><br><span class="line">        .pipe(plugins.if(<span class="regexp">/\.css$/</span>, plugins.cleanCss()))     <span class="comment">// css压缩</span></span><br><span class="line">        .pipe(plugins.if(<span class="regexp">/\.js$/</span>, plugins.uglify()))        <span class="comment">// js压缩</span></span><br><span class="line">        .pipe(dest(<span class="string">&#x27;dist&#x27;</span>))          <span class="comment">// 目标文件夹由dist改为其他，防止读写冲突导致读写失败</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 组合任务</span></span><br><span class="line"><span class="keyword">const</span> compile = parallel(style, script, page)      <span class="comment">// 编译</span></span><br><span class="line"><span class="keyword">const</span> build = series(            <span class="comment">// 构建</span></span><br><span class="line">    clean,</span><br><span class="line">    parallel(</span><br><span class="line">        series(compile, useref),</span><br><span class="line">        image,</span><br><span class="line">        font,</span><br><span class="line">        extra</span><br><span class="line">    )</span><br><span class="line">)</span><br><span class="line"><span class="keyword">const</span> develop = series(compile, serve)      <span class="comment">// 开发阶段构建+热更新服务</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    clean,</span><br><span class="line">    build,</span><br><span class="line">    develop,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="构建任务补充"><a href="#构建任务补充" class="headerlink" title="构建任务补充"></a>构建任务补充</h1><p>将导出的任务定义到 <code>package.json</code> 的 <code>scripts</code> 中，使用 <code>yarn clean</code> 等命令执行任务；</p><p><img src="/2021/08/10/gulp-02/scripts%E5%91%BD%E4%BB%A4.jpg" alt="scripts命令"></p><p>在 <code>.ignore</code> 文件中添加 <code>temp</code> 和 <code>dist</code> 目录；</p><p>以上就是使用 <code>gulp</code> 创建构建任务的整个流程，只要把这个作为模板使用就行，后续我们还可以对工作流进行封装发布，我们下一篇再见。console.log(‘Gulp ♥♥♥’)</p></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content"><link itemprop="mainEntityOfPage" href="https://seachan0117.github.io/2021/08/10/init-gridsome/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/miao.png"><meta itemprop="name" content="Sea Chan"><meta itemprop="description" content="Sea Chan's blogs"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="SeaChan"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2021/08/10/init-gridsome/" class="post-title-link" itemprop="url">gridsome 安裝</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2021-08-10 01:57:19" itemprop="dateCreated datePublished" datetime="2021-08-10T01:57:19+00:00">2021-08-10</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Tools/" itemprop="url" rel="index"><span itemprop="name">Tools</span></a></span></span></div></div></header><div class="post-body" itemprop="articleBody"><p>Gridsome 初始化安装，参照<a target="_blank" rel="noopener" href="https://www.gridsome.cn/docs/#how-to-install">官网</a></p><h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><p>全局安装 gridsome 的脚手架工具，<code>yarn global add @gridsome/cli</code></p><h1 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h1><h2 id="sharp"><a href="#sharp" class="headerlink" title="sharp"></a>sharp</h2><p>官方给出在上一步安装脚手架后，可直接使用脚手架命令 <code>gridsome create my-gridsome-site</code> 创建一个名为 my-gridsome-site 的初始化项目，但是这样创建很难成功，因为 gridsome 依赖第三方的包 sharp，用于处理图片，它包含很多 C++ 文件，安装时需要编译，即需要 C++ 编译环境；sharp 还依赖一个 libvips 包，该包文件较大，在国内下载容易失败，即导致 sharp 难以安装成功；<a target="_blank" rel="noopener" href="https://sharp.pixelplumbing.com/install#chinese-mirror">sharp官网</a> 提供了一个中国镜像解决该问题；</p><div class="post-button"><a class="btn" href="/2021/08/10/init-gridsome/#more" rel="contents">阅读全文 &raquo;</a></div></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content"><link itemprop="mainEntityOfPage" href="https://seachan0117.github.io/2021/07/18/vue3-reactive/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/miao.png"><meta itemprop="name" content="Sea Chan"><meta itemprop="description" content="Sea Chan's blogs"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="SeaChan"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2021/07/18/vue3-reactive/" class="post-title-link" itemprop="url">Vue3 响应式原理手写实现</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2021-07-18 17:04:01" itemprop="dateCreated datePublished" datetime="2021-07-18T17:04:01+00:00">2021-07-18</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2021-08-10 01:57:19" itemprop="dateModified" datetime="2021-08-10T01:57:19+00:00">2021-08-10</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Vue3/" itemprop="url" rel="index"><span itemprop="name">Vue3</span></a></span></span></div></div></header><div class="post-body" itemprop="articleBody"><h1 id="Vue3-响应式原理回顾"><a href="#Vue3-响应式原理回顾" class="headerlink" title="Vue3 响应式原理回顾"></a>Vue3 响应式原理回顾</h1><ul><li>Proxy 对象实现属性监听</li><li>多层属性嵌套时，在访问属性过程中处理下一级属性</li><li>默认监听动态添加的属性</li><li>默认监听属性的删除操作</li><li>默认监听数组索引和 length 属性</li><li>可以作为单独的模块使用</li></ul><div class="post-button"><a class="btn" href="/2021/07/18/vue3-reactive/#more" rel="contents">阅读全文 &raquo;</a></div></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content"><link itemprop="mainEntityOfPage" href="https://seachan0117.github.io/2021/07/17/compositionAPI/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/miao.png"><meta itemprop="name" content="Sea Chan"><meta itemprop="description" content="Sea Chan's blogs"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="SeaChan"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2021/07/17/compositionAPI/" class="post-title-link" itemprop="url">Composition API</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2021-07-17 17:36:18" itemprop="dateCreated datePublished" datetime="2021-07-17T17:36:18+00:00">2021-07-17</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2021-08-10 01:57:19" itemprop="dateModified" datetime="2021-08-10T01:57:19+00:00">2021-08-10</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Vue3/" itemprop="url" rel="index"><span itemprop="name">Vue3</span></a></span></span></div></div></header><div class="post-body" itemprop="articleBody"><h1 id="Composition-API"><a href="#Composition-API" class="headerlink" title="Composition API"></a>Composition API</h1><h2 id="Composition-API-1"><a href="#Composition-API-1" class="headerlink" title="Composition API"></a>Composition API</h2><p>Composition API 是 vue3 中新增的 API，使用传统的option配置方法写组件的时候问题，随着业务复杂度越来越高，代码量会不断的加大；由于相关业务的代码需要遵循option的配置写到特定的区域，导致后续维护非常的复杂，同时代码可复用性不高，而composition-api就是为了解决这个问题而生的。</p><p>Composition API 提供了几个函数：</p><div class="post-button"><a class="btn" href="/2021/07/17/compositionAPI/#more" rel="contents">阅读全文 &raquo;</a></div></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content"><link itemprop="mainEntityOfPage" href="https://seachan0117.github.io/2021/07/17/vue3-introduce/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/miao.png"><meta itemprop="name" content="Sea Chan"><meta itemprop="description" content="Sea Chan's blogs"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="SeaChan"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2021/07/17/vue3-introduce/" class="post-title-link" itemprop="url">Vue3 介绍</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2021-07-17 15:59:08" itemprop="dateCreated datePublished" datetime="2021-07-17T15:59:08+00:00">2021-07-17</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2021-08-10 01:57:19" itemprop="dateModified" datetime="2021-08-10T01:57:19+00:00">2021-08-10</time></span></div></div></header><div class="post-body" itemprop="articleBody"><h1 id="Vue-js-3-0-源码组织方式"><a href="#Vue-js-3-0-源码组织方式" class="headerlink" title="Vue.js 3.0 源码组织方式"></a>Vue.js 3.0 源码组织方式</h1><p>1.源码采用 TypeScript 重写，语言类型化提升代码的可维护性；</p><p>2.使用 Monorepo 管理项目结构，把不同功能的代码放在不同的 package 中管理，功能模块划分明确，依赖关系明确，功能模块也可单独使用；</p><div class="post-button"><a class="btn" href="/2021/07/17/vue3-introduce/#more" rel="contents">阅读全文 &raquo;</a></div></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content"><link itemprop="mainEntityOfPage" href="https://seachan0117.github.io/2021/06/19/hexo-asset-image-cs/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/miao.png"><meta itemprop="name" content="Sea Chan"><meta itemprop="description" content="Sea Chan's blogs"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="SeaChan"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2021/06/19/hexo-asset-image-cs/" class="post-title-link" itemprop="url">Hexo 图片插入插件的使用</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2021-06-19 20:47:26" itemprop="dateCreated datePublished" datetime="2021-06-19T20:47:26+00:00">2021-06-19</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2021-08-10 01:57:19" itemprop="dateModified" datetime="2021-08-10T01:57:19+00:00">2021-08-10</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Hexo/" itemprop="url" rel="index"><span itemprop="name">Hexo</span></a></span></span></div></div></header><div class="post-body" itemprop="articleBody"><p>都说 Hexo 是 markdown 语法，插入图片不也用语法插入就OK了么，但是我在插入图片时，遇到了问题。</p><p>我使用过 github 路径，码云路径，都有问题；具体可自行尝试，本文主要简述插件的使用。<br>哦，对了，我还使用过把图片转为 base64 编码的数据用于插入的，问题是解决了，新的麻烦又来了，文章要插入大量图片时，真的很烦QAQ。</p><div class="post-button"><a class="btn" href="/2021/06/19/hexo-asset-image-cs/#more" rel="contents">阅读全文 &raquo;</a></div></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content"><link itemprop="mainEntityOfPage" href="https://seachan0117.github.io/2021/06/19/my-SSR/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/miao.png"><meta itemprop="name" content="Sea Chan"><meta itemprop="description" content="Sea Chan's blogs"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="SeaChan"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2021/06/19/my-SSR/" class="post-title-link" itemprop="url">搭建自己的 Vue-SSR</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2021-06-19 17:01:18" itemprop="dateCreated datePublished" datetime="2021-06-19T17:01:18+00:00">2021-06-19</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2021-08-10 01:57:19" itemprop="dateModified" datetime="2021-08-10T01:57:19+00:00">2021-08-10</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E5%A4%A7%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">大前端</span></a> </span>， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E5%A4%A7%E5%89%8D%E7%AB%AF/SSR/" itemprop="url" rel="index"><span itemprop="name">SSR</span></a></span></span></div></div></header><div class="post-body" itemprop="articleBody"><h1 id="SSR（Server-Side-Render）"><a href="#SSR（Server-Side-Render）" class="headerlink" title="SSR（Server Side Render）"></a>SSR（Server Side Render）</h1><h2 id="什么是-SSR"><a href="#什么是-SSR" class="headerlink" title="什么是 SSR"></a>什么是 SSR</h2><p>SSR 是 Server Side Render 简称，就是在服务端进行渲染生成 HTML 文件，浏览器显示生成的 HTML 文件， 补充：我们传统使用的属于 CSR 是 Client Side Render ，页面上的内容是我们加载的 JS 文件渲染出来的，文件运行在浏览器上面。</p><div class="post-button"><a class="btn" href="/2021/06/19/my-SSR/#more" rel="contents">阅读全文 &raquo;</a></div></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content"><link itemprop="mainEntityOfPage" href="https://seachan0117.github.io/2021/06/18/github-action-deploy/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/miao.png"><meta itemprop="name" content="Sea Chan"><meta itemprop="description" content="Sea Chan's blogs"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="SeaChan"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2021/06/18/github-action-deploy/" class="post-title-link" itemprop="url">Github Actions 自动化构建服务</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2021-06-18 11:10:04" itemprop="dateCreated datePublished" datetime="2021-06-18T11:10:04+00:00">2021-06-18</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2021-08-10 01:57:19" itemprop="dateModified" datetime="2021-08-10T01:57:19+00:00">2021-08-10</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E5%A4%A7%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">大前端</span></a> </span>， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E5%A4%A7%E5%89%8D%E7%AB%AF/%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2/" itemprop="url" rel="index"><span itemprop="name">自动化部署</span></a></span></span></div></div></header><div class="post-body" itemprop="articleBody"><p><strong>CI/CD</strong> 已经是现代互联网项目的主流，它能帮助我们处理繁琐的打包构建工作，本博客是基于 <strong>Travis CI</strong> 构建的，最近在学习中遇到了 Github Actions，感觉很强大，很好玩，就此记录一下学习过程中的使用。</p><h1 id="Github-Actions"><a href="#Github-Actions" class="headerlink" title="Github Actions"></a>Github Actions</h1><p>GitHub Actions 是 GitHub 于2018年10月推出的持续集成服务。<br>官方定义如下，在 GitHub Actions 的仓库中自动化、自定义和执行软件开发工作流程。 您可以发现、创建和共享操作以执行您喜欢的任何作业（包括 CI/CD），并将操作合并到完全自定义的工作流程中。</p><div class="post-button"><a class="btn" href="/2021/06/18/github-action-deploy/#more" rel="contents">阅读全文 &raquo;</a></div></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content"><link itemprop="mainEntityOfPage" href="https://seachan0117.github.io/2021/06/11/gulp-01/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/miao.png"><meta itemprop="name" content="Sea Chan"><meta itemprop="description" content="Sea Chan's blogs"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="SeaChan"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2021/06/11/gulp-01/" class="post-title-link" itemprop="url">前端工程化之 Gulp</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2021-06-11 22:07:40" itemprop="dateCreated datePublished" datetime="2021-06-11T22:07:40+00:00">2021-06-11</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2021-08-10 01:57:19" itemprop="dateModified" datetime="2021-08-10T01:57:19+00:00">2021-08-10</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E5%A4%A7%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">大前端</span></a> </span>， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E5%A4%A7%E5%89%8D%E7%AB%AF/%E5%B7%A5%E7%A8%8B%E5%8C%96/" itemprop="url" rel="index"><span itemprop="name">工程化</span></a></span></span></div></div></header><div class="post-body" itemprop="articleBody"><p><img src="/2021/06/11/gulp-01/bg.jpg" alt="gulp"></p><p>在前端项目日益复杂的今天，开发效率的提升显得尤为重要，大前端大势所趋，项目工程化也成为一个合格前端开发者必不可缺的技能之一。</p><p>前端项目工程化能解决一系列开发时遇到的问题，包括：</p><div class="post-button"><a class="btn" href="/2021/06/11/gulp-01/#more" rel="contents">阅读全文 &raquo;</a></div></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><nav class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a></nav></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2021</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Sea Chan</span></div><div class="busuanzi-count"><span class="post-meta-item" id="busuanzi_container_site_uv"><span class="post-meta-item-icon"><i class="fa fa-user"></i> </span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span> </span></span><span class="post-meta-item" id="busuanzi_container_site_pv"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div></div></footer><script size="300" alpha="0.6" zindex="-1" src="https://cdn.jsdelivr.net/npm/ribbon.js@1.0.2/dist/ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script><script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/third-party/search/local-search.js"></script><script class="next-config" data-name="nprogress" type="application/json">{&quot;enable&quot;:true,&quot;spinner&quot;:true}</script><script src="/js/third-party/nprogress.js"></script><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous"><script class="next-config" data-name="gitalk" type="application/json">{&quot;enable&quot;:true,&quot;github_id&quot;:&quot;seachan0117&quot;,&quot;repo&quot;:&quot;seachan0117.github.io&quot;,&quot;client_id&quot;:&quot;40edc46fcd586990c3ea&quot;,&quot;client_secret&quot;:&quot;5a55478d7c493455907dfacf6315f9b0d6bf3702&quot;,&quot;admin_user&quot;:&quot;seachan0117&quot;,&quot;distraction_free_mode&quot;:true,&quot;proxy&quot;:&quot;https:&#x2F;&#x2F;cors-anywhere.azm.workers.dev&#x2F;https:&#x2F;&#x2F;github.com&#x2F;login&#x2F;oauth&#x2F;access_token&quot;,&quot;language&quot;:null,&quot;js&quot;:{&quot;url&quot;:&quot;https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;npm&#x2F;gitalk@1.7.2&#x2F;dist&#x2F;gitalk.min.js&quot;,&quot;integrity&quot;:&quot;sha256-Pmj85ojLaPOWwRtlMJwmezB&#x2F;Qg8BzvJp5eTzvXaYAfA&#x3D;&quot;},&quot;path_md5&quot;:&quot;d1546d731a9f30cc80127d57142a482b&quot;}</script><script src="/js/third-party/comments/gitalk.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,log:!1,model:{jsonPath:"/live2dw/assets/hijiki.model.json"},display:{position:"right",width:150,height:300},mobile:{show:!0}})</script></body></html>